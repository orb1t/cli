package com.pyxis.cli.gnu;

import com.pyxis.cli.CommandLineDescription;
import com.pyxis.cli.Option;
import com.pyxis.cli.gnu.GnuOptionDescription;
import com.pyxis.cli.OptionDescription;

import java.util.ArrayList;
import java.util.List;
import java.io.IOException;

public class GnuCommandLineDescription implements CommandLineDescription
{
    private final int optionsColumnWidth;

    private final List<Option> options = new ArrayList<Option>();
    private String banner;

    public GnuCommandLineDescription()
    {
        this( 30 );
    }

    public GnuCommandLineDescription( int optionsColumnWidth )
    {
        this.optionsColumnWidth = optionsColumnWidth;
    }

    public void appendBanner(String banner)
    {
        this.banner = banner;
    }

    public void appendOption(Option option)
    {
        options.add( option );
    }

    public void appendTo(Appendable output) throws IOException
    {
        output.append( "Usage: " );
        if (banner != null) output.append(banner);
        if (options.isEmpty()) return;

        output.append("\n\n").append("Options:");
        for (Option option : options)
        {
            output.append("\n");
            OptionDescription description = new GnuOptionDescription( optionsColumnWidth );
            option.describeTo( description );
            description.appendTo( output );
        }
    }
}
